/*! pinny 2.0.4 (https://github.com/mobify/pinny.git) */
!function(a){if("function"==typeof define&&define.amd)define(["$","plugin","bouncefix","event-polyfill","velocity","lockup","shade","deckard","isChildOf"],a);else{var b=window.Zepto||window.jQuery;a(b,window.Plugin,window.bouncefix,window.EventPolyfill)}}(function(a,b,c,d){function e(a,b){e.__super__.call(this,a,b,e.DEFAULTS)}var f="Pinny requires a declared effect to operate. For more information read: https://github.com/mobify/pinny#initializing-the-plugin",g="a[href], area[href], input, select, textarea, button, iframe, object, embed, [tabindex], [contenteditable]",h='input[type="text"], input[type="email"], input[type="password"],input[type="tel"], input[type="search"], input[type="number"],select, textarea';Function.prototype.bind||(Function.prototype.bind=function(a){var b=this;return function(){return b.apply(a)}});var i=a(window),j=a.os.ios&&a.os.major<=7||a.os.android&&a.os.major<=4,k={PINNY:"pinny",HEADER:"pinny__header",WRAPPER:"pinny__wrapper",SPACER:"pinny__spacer",TITLE:"pinny__title",CLOSE:"pinny__close",CONTENT:"pinny__content",OPENED:"pinny--is-open",SCROLLABLE:"pinny--is-scrollable"},l={COMPONENT:'<{0} class="'+k.PINNY+'__{0}">{1}</{0}>',HEADER:'<h1 class="'+k.TITLE+'">{0}</h1><button class="'+k.CLOSE+'">Close</button>',FOOTER:"{0}"},m={click:"click.pinny",focus:"focus.pinny",blur:"blur.pinny",resize:"resize.pinny",orientationchange:"orientationchange.pinny"};return e.VERSION="2.0.4",e.DEFAULTS={effect:null,container:null,appendTo:null,structure:{header:"",footer:!1},zIndex:2,cssClass:"",coverage:"100%",easing:"swing",duration:200,shade:{},open:a.noop,opened:a.noop,close:a.noop,closed:a.noop,scrollDuration:50,spacerHeight:300,pageContentSelector:"#x-root"},b.create("pinny",e,{animation:{openComplete:function(){setTimeout(function(){this._focus(),this._disableExternalInputs(),this._activePinnies()?this.$pinny.data("lockup")._trigger("locked"):(i.on(m.orientationchange,this._blurActiveElement.bind(this)),this.$pinny.lockup("lock")),d.on(m.resize,this._repaint),this.$pinny.addClass(k.OPENED).attr("aria-hidden","false"),this.$container.attr("aria-hidden","true"),this._trigger("opened")}.bind(this),0)},closeComplete:function(){setTimeout(function(){this.$pinny.removeClass(k.OPENED).attr("aria-hidden","true"),this._activePinnies()?this.$pinny.data("lockup")._trigger("unlocked"):(this.$pinny.lockup("unlock"),d.off(m.resize),i.off(m.orientationchange)),this.$container.attr("aria-hidden","false"),this._resetFocus(),this._enableExternalInputs(),this._trigger("closed")}.bind(this),0)}},_init:function(b){if(this.id="pinny-"+a.uniqueId(),this.$element=a(b),this.$doc=a(document),this.$body=a("body"),this._build(),!this.options.effect)throw f;this.effect=this.options.effect.call(this),this.$element.removeAttr("hidden"),this._bindEvents()},destroy:function(){this.$pinny.lockup("destroy"),this.$pinny.shade("destroy"),this.$pinny.remove(),d.off(),this.$element.appendTo(document.body).removeData(this.name)},toggle:function(){this[this.$pinny.hasClass(k.OPENED)?"close":"open"]()},open:function(){this._isOpen()||(this._trigger("open"),this.originalActiveElement=document.activeElement,c.add(k.SCROLLABLE),this.options.shade&&this.$shade.shade("open"),this.effect.open.call(this))},close:function(){this._isOpen()&&(this._trigger("close"),c.remove(k.SCROLLABLE),this.options.shade&&this.$shade.shade("close"),this.effect.close.call(this))},_isOpen:function(){return this.$pinny.hasClass(k.OPENED)},_bindEvents:function(){var b=this.$pinny;b.on("touchmove",function(b){a(b.target).parents().hasClass(k.CONTENT)||b.preventDefault()})},_build:function(){var b=this;if(this.$pinny=a("<section />").addClass(k.PINNY).addClass(this.options.cssClass).css({position:"fixed",zIndex:this.options.zIndex,width:this.options.coverage,height:this.options.coverage}).on(m.click,"."+k.CLOSE,function(a){a.preventDefault(),b.close()}).lockup({container:this.options.container,locked:function(){b._handleKeyboardShown()},unlocked:function(){b._handleKeyboardHidden()}}),this.$container,this.$container=a(this.options.pageContentSelector).length?a(this.options.pageContentSelector):this.$pinny.data("lockup").$container,this.$pinny.appendTo(this.options.appendTo?a(this.options.appendTo):this.$body),this.options.structure){var c=a("<div />").addClass(k.WRAPPER).attr("tabindex","0").appendTo(this.$pinny);this._buildComponent("header").appendTo(c),a("<div />").addClass(k.CONTENT).addClass(k.SCROLLABLE).attr("tabindex","0").append(this.$element).appendTo(c),this._buildComponent("footer").appendTo(c)}else this.$element.appendTo(this.$pinny);this.$header=this.$pinny.find("."+k.HEADER),this.$content=this.$pinny.find("."+k.CONTENT),this.$spacer=a("<div />").addClass(k.SPACER).height(this.options.spacerHeight).attr("hidden","hidden").appendTo(this.$content),this._addAccessibility(),this.options.shade&&(this.$shade=this.$pinny.shade(a.extend(!0,{},{click:function(){b.close()}},a.extend(this.options.shade,{duration:this.options.duration}))))},_buildComponent:function(b){var c=this.options.structure[b],d=a([]);if(c!==!1){var e=this._isHtml(c)?c:l[b.toUpperCase()].replace("{0}",c);d=a(l.COMPONENT.replace(/\{0\}/g,b).replace(/\{1\}/g,e))}return d},_isHtml:function(a){return/<[a-z][\s\S]*>/i.test(a)},_activePinnies:function(){return!!a("."+k.OPENED).length},_coverage:function(a){var b,c=this.options.coverage.match(/(\d*)%$/);return c&&(b=100-parseInt(c[1]),a&&(b/=a)),c?b+"%":this.options.coverage},_addAccessibility:function(){var a=this.id+"__header",b=this.$pinny.find("h1, ."+k.TITLE).first(),c=this.$pinny.find("."+k.WRAPPER);this.$container.attr("aria-hidden","false"),this.$pinny.attr("role","dialog").attr("aria-labelledby",a).attr("aria-hidden","true").attr("tabindex","-1"),c.attr("role","document"),b.attr("id",a)},_repaint:function(){window.scrollTo(document.body.scrollLeft,document.body.scrollTop+1)},_focus:function(){this.$pinny.find("."+k.WRAPPER).focus()},_resetFocus:function(){this.originalActiveElement&&this.originalActiveElement.focus()},_disableExternalInputs:function(){if(!this.$pinny.lockup("isLocked")){var b=a(g).not(function(){return a(this).isChildOf("."+k.PINNY)});b.each(function(b,c){var d=a(c),e=d.attr("tabindex")||0;d.attr("data-orig-tabindex",e).attr("tabindex","-1")})}},_enableExternalInputs:function(){this._activePinnies()||a("[data-orig-tabindex]").each(function(b,c){var d=a(c),e=parseInt(d.attr("data-orig-tabindex"));e?d.attr("tabindex",e):d.removeAttr("tabindex"),d.removeAttr("data-orig-tabindex")})},_handleKeyboardShown:function(){j&&this.$pinny.find(h).on(m.focus,this._showSpacer.bind(this)).on(m.blur,this._hideSpacer.bind(this))},_handleKeyboardHidden:function(){j&&this.$pinny.find(h).off(m.focus).off(m.blur)},_showSpacer:function(){this.$spacer.removeAttr("hidden")},_hideSpacer:function(){!this._activeElement().is(h)&&this.$spacer.attr("hidden","")},_activeElement:function(){return a(document.activeElement)},_blurActiveElement:function(){this._activeElement().blur()}}),a("[data-pinny]").each(function(){var b=a(this),c=a(this).data("pinny");if(!c.length)throw f;b.pinny({effect:c})}),a});