/*! pinny 3.0.0 (https://github.com/mobify/pinny.git) */
!function(a){if("function"==typeof define&&define.amd)define(["$","plugin","bouncefix","event-polyfill","velocity","lockup","shade","deckard","isChildOf"],a);else{var b=window.jQuery;a(b,window.Plugin,window.bouncefix,window.EventPolyfill)}}(function(a,b,c,d){var e="Pinny requires a declared effect to operate. For more information read: https://github.com/mobify/pinny#initializing-the-plugin",f="a[href], area[href], input, select, textarea, button, iframe, object, embed, [tabindex], [contenteditable]",g='input[type="text"], input[type="email"], input[type="password"],input[type="tel"], input[type="search"], input[type="number"],select, textarea';Function.prototype.bind||(Function.prototype.bind=function(a){var b=this;return function(){return b.apply(a)}});var h=a(window),i=a.os.ios&&a.os.major<=7||a.os.android&&a.os.major<=4,j={PINNY:"pinny",HEADER:"pinny__header",WRAPPER:"pinny__wrapper",SPACER:"pinny__spacer",TITLE:"pinny__title",CLOSE:"pinny__close",CONTENT:"pinny__content",OPENED:"pinny--is-open",SCROLLABLE:"pinny--is-scrollable"},k={COMPONENT:'<{0} class="'+j.PINNY+'__{0}">{1}</{0}>',HEADER:'<h1 class="'+j.TITLE+'">{0}</h1><button class="'+j.CLOSE+'">Close</button>',FOOTER:"{0}"},l={click:"click.pinny",focus:"focus.pinny",blur:"blur.pinny",resize:"resize.pinny",orientationchange:"orientationchange.pinny"},m=function(a,b){m.__super__.call(this,a,b,m.DEFAULTS)};return m.VERSION="3.0.0",m.DEFAULTS={effect:null,container:null,appendTo:null,structure:{header:"",footer:!1},zIndex:2,cssClass:"",coverage:"100%",easing:"swing",duration:200,shade:{},open:a.noop,opened:a.noop,close:a.noop,closed:a.noop,scrollDuration:50,spacerHeight:300},b.create("pinny",m,{animation:{openComplete:function(){setTimeout(function(){this._disableExternalInputs(),this._focus(),this._activePinnies()?this.$pinny.data("lockup")._trigger("locked"):(h.on(l.orientationchange,this._blurActiveElement.bind(this)),this.$pinny.lockup("lock")),d.on(l.resize,this._repaint),this.$pinny.addClass(j.OPENED).attr("aria-hidden","false"),this.$container.attr("aria-hidden","true"),this._trigger("opened")}.bind(this),0)},closeComplete:function(){setTimeout(function(){this.$pinny.removeClass(j.OPENED).attr("aria-hidden","true"),this._enableExternalInputs(),this._resetFocus(),this._activePinnies()?this.$pinny.data("lockup")._trigger("unlocked"):(this.$pinny.lockup("unlock"),d.off(l.resize),h.off(l.orientationchange)),this.$container.attr("aria-hidden","false"),this._trigger("closed")}.bind(this),0)}},_init:function(b){if(this.id="pinny-"+a.uniqueId(),this.$element=a(b),this.$doc=a(document),this.$body=a("body"),this._build(),!this.options.effect)throw e;this.effect=this.options.effect.call(this),this.$element.removeAttr("hidden"),this._bindEvents()},destroy:function(){this.$pinny.lockup("destroy"),this.$pinny.shade("destroy"),this.$pinny.remove(),d.off(),this.$element.appendTo(document.body).removeData(this.name)},toggle:function(){this[this.$pinny.hasClass(j.OPENED)?"close":"open"]()},open:function(){this._isOpen()||(this._trigger("open"),c.add(j.SCROLLABLE),this.options.shade&&this.$shade.shade("open"),this.effect.open.call(this))},close:function(){this._isOpen()&&(this._trigger("close"),c.remove(j.SCROLLABLE),this.options.shade&&this.$shade.shade("close"),this.effect.close.call(this))},_isOpen:function(){return this.$pinny.hasClass(j.OPENED)},_bindEvents:function(){var b=this.$pinny;b.on("touchmove",function(b){a(b.target).parents().hasClass(j.CONTENT)||b.preventDefault()})},_build:function(){var b=this;if(this.$pinny=a("<section />").addClass(j.PINNY).addClass(this.options.cssClass).css({position:"fixed",zIndex:this.options.zIndex,width:this.options.coverage,height:this.options.coverage}).on(l.click,"."+j.CLOSE,function(a){a.preventDefault(),b.close()}).lockup({container:this.options.container,locked:function(){b._handleKeyboardShown()},unlocked:function(){b._handleKeyboardHidden()}}),this.$container=this.$pinny.data("lockup").$container,this.$pinny.appendTo(this.options.appendTo?a(this.options.appendTo):this.$container),this.options.structure){var c=a("<div />").addClass(j.WRAPPER).appendTo(this.$pinny);this._buildComponent("header").appendTo(c),a("<div />").addClass(j.CONTENT).addClass(j.SCROLLABLE).append(this.$element).appendTo(c),this._buildComponent("footer").appendTo(c)}else this.$element.appendTo(this.$pinny);this.$header=this.$pinny.find("."+j.HEADER),this.$content=this.$pinny.find("."+j.CONTENT),this.$spacer=a("<div />").addClass(j.SPACER).height(this.options.spacerHeight).attr("hidden","hidden").appendTo(this.$content),this._addAccessibility(),this.options.shade&&(this.$shade=this.$pinny.shade(a.extend(!0,{},{click:function(){b.close()}},a.extend(this.options.shade,{duration:this.options.duration}))))},_buildComponent:function(b){var c=this.options.structure[b],d=a([]);if(c!==!1){var e=this._isHtml(c)?c:k[b.toUpperCase()].replace("{0}",c);d=a(k.COMPONENT.replace(/\{0\}/g,b).replace(/\{1\}/g,e))}return d},_isHtml:function(a){return/<[a-z][\s\S]*>/i.test(a)},_activePinnies:function(){return!!a("."+j.OPENED).length},_coverage:function(a){var b,c=this.options.coverage.match(/(\d*)%$/);return c&&(b=100-parseInt(c[1]),a&&(b/=a)),c?b+"%":this.options.coverage},_addAccessibility:function(){var a=this.id+"__header",b=this.$pinny.find("h1, ."+j.TITLE).first(),c=this.$pinny.find("."+j.WRAPPER);this.$container.attr("aria-hidden","false"),this.$pinny.attr("role","dialog").attr("aria-labelledby",a).attr("aria-hidden","true").attr("tabindex","-1"),c.attr("role","document"),b.attr("id",a)},_repaint:function(){window.scrollTo(document.body.scrollLeft,document.body.scrollTop+1)},_focus:function(){this.originalActiveElement=document.activeElement,this.$pinny.children().first().focus()},_resetFocus:function(){this.originalActiveElement&&this.originalActiveElement.focus()},_disableExternalInputs:function(){if(!this.$pinny.lockup("isLocked")){var b=a(f).not(function(){return a(this).isChildOf("."+j.PINNY)});b.each(function(b,c){var d=a(c),e=d.attr("tabindex")||0;d.attr("data-orig-tabindex",e).attr("tabindex","-1")})}},_enableExternalInputs:function(){this._activePinnies()||a("[data-orig-tabindex]").each(function(b,c){var d=a(c),e=parseInt(d.attr("data-orig-tabindex"));e?d.attr("tabindex",e):d.removeAttr("tabindex"),d.removeAttr("data-orig-tabindex")})},_handleKeyboardShown:function(){i&&this.$pinny.find(g).on(l.focus,this._showSpacer.bind(this)).on(l.blur,this._hideSpacer.bind(this))},_handleKeyboardHidden:function(){i&&this.$pinny.find(g).off(l.focus).off(l.blur)},_showSpacer:function(){this.$spacer.removeAttr("hidden")},_hideSpacer:function(){!this._activeElement().is(g)&&this.$spacer.attr("hidden","")},_activeElement:function(){return a(document.activeElement)},_blurActiveElement:function(){this._activeElement().blur()}}),a("[data-pinny]").each(function(){var b=a(this),c=a(this).data("pinny");if(!c.length)throw e;b.pinny({effect:c})}),a});